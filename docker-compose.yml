version: '3'
services:
  db:
    image: mysql:8.0
    env_file:
      - ./.mysql_env
    command: >
      /bin/bash -c "--default_authentication_plugin=mysql_native_password && 
      echo "GRANT ALL PRIVILEGES ON test_django_db.* TO 'django'@'%';" | 
      mysql -u root -p $ROOT_PASSWORD"
  web:
    build: .
    volumes:
      - .:/code
    ports:
      - "80:80"
      - "443:443"
      - "8000:8000"
    depends_on:
      - db
#     networks:
#       application_net:
#         ipv4_address: 172.20.0.3
# networks:
#   application_net:
#     driver: bridge
#     ipam:
#       driver: default
#       config:
#         - subnet: 172.20.0.0/16
